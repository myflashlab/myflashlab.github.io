<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><!-- saved from url=(0014)about:internet --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="../../../../../../style.css" type="text/css" media="screen"><link rel="stylesheet" href="../../../../../../print.css" type="text/css" media="print"><link rel="stylesheet" href="../../../../../../override.css" type="text/css"><meta name="keywords" content="Transaction,com.myflashlab.air.extensions.firebase.firestore.Transaction,ADDED,ASCENDING,BATCH_FAILURE,BATCH_SUCCESS,COLLECTION_ADD_FAILURE,COLLECTION_ADD_SUCCESS,DELETE,DESCENDING,DOCUMENT_DELETE_FAILURE,DOCUMENT_DELETE_SUCCESS,DOCUMENT_EVENT_FAILURE,DOCUMENT_EVENT_SUCCESS,DOCUMENT_GET_FAILURE,DOCUMENT_GET_SUCCESS,DOCUMENT_SET_FAILURE,DOCUMENT_SET_SUCCESS,DOCUMENT_UPDATE_FAILURE,DOCUMENT_UPDATE_SUCCESS,EXTENSION_ID,MODIFIED,QUERY_EVENT_FAILURE,QUERY_EVENT_SUCCESS,QUERY_GET_FAILURE,QUERY_GET_SUCCESS,REMOVED,TIMESTAMP,TRANSACTION_BEGIN,TRANSACTION_COMPLETE,TRANSACTION_FAILURE,changeType,collectionId,data,documentChanges,documentId,documentReference,documentSnapshot,document,documents,firestoreSettings,hasPendingWrites,host,includeDocumentMetadataChanges,includeMetadataChanges,includeQueryMetadataChanges,isEmpty,isFromCache,isPersistenceEnabled,isSslEnabled,metadata,metadata,msg,newIndex,oldIndex,outcome,parent,parent,path,path,querySnapshot,reference,reference,size,snapshotId,transactionOutcome,abort,add,addEventListener,addEventListener,addSnapshotListener,addSnapshotListener,batch,cleanAllReferences,collection,collection,commit,createTransaction,disableNetwork,document,document,enableNetwork,endAt,endBefore,execute,init,keep,limit,merge,mergeFields,omit,omit,omit,orderBy,read,read,read,removeEventListener,removeEventListener,removeSnapshotListener,removeSnapshotListener,startAfter,startAt,update,update,update,whereEqualTo,whereGreaterThan,whereGreaterThanOrEqualTo,whereLessThan,whereLessThanOrEqualTo,write,write,write"><title>com.myflashlab.air.extensions.firebase.firestore.Transaction</title><script src="../../../../../../AC_OETags.js" type="text/javascript"></script></head><body><script language="javascript" type="text/javascript" src="../../../../../../asdoc.js"></script><script language="javascript" type="text/javascript" src="../../../../../../help.js"></script><script language="javascript" type="text/javascript" src="../../../../../../cookies.js"></script><script language="javascript" type="text/javascript"><!--
				asdocTitle = 'Transaction - Myflashlabs';
				var baseRef = '../../../../../../';
				window.onload = configPage;
			--></script>
<script type="text/javascript">
			scrollToNameAnchor();
		</script><table class="titleTable" cellpadding="0" cellspacing="0" id="titleTable" style="display:none"><tr><td class="titleTableTitle" align="left">Myflashlabs ANEs</td><td class="titleTableTopNav" align="right"><a href="../../../../../../package-summary.html" onclick="loadClassListFrame('../../../../../../all-classes.html')">All Packages</a>&nbsp;|&nbsp;<a href="../../../../../../class-summary.html" onclick="loadClassListFrame('../../../../../../all-classes.html')">All Classes</a>&nbsp;|&nbsp;<a href="../../../../../../all-index-A.html" onclick="loadClassListFrame('../../../../../../index-list.html')">Index</a>&nbsp;|&nbsp;<a id="framesLink1" href="../../../../../../index.html?com/myflashlab/air/extensions/firebase/firestore/Transaction.html&amp;com/myflashlab/air/extensions/firebase/firestore/class-list.html">Frames</a><a id="noFramesLink1" style="display:none" href="" onclick="parent.location=document.location"> No Frames </a></td><td class="titleTableLogo" align="right" rowspan="3"><img src="../../../../../../images/logo.jpg" class="logoImage" alt="AdobeLogo" title="AdobeLogo"></td></tr><tr class="titleTableRow2"><td class="titleTableSubTitle" id="subTitle" align="left">Transaction</td><td class="titleTableSubNav" id="subNav" align="right"><a href="#propertySummary">Properties</a>&nbsp;| <a href="#methodSummary">Methods</a>&nbsp;| <a href="#includeExamplesSummary">Examples</a></td></tr><tr class="titleTableRow3"><td colspan="3">&nbsp;</td></tr></table><script language="javascript" type="text/javascript" xml:space="preserve">
				<!--
				
					if (!isEclipse() || window.name != ECLIPSE_FRAME_NAME) {titleBar_setSubTitle("Transaction"); titleBar_setSubNav(false,true,false,false,false,false,false,false,true,true,false	,false,false,false,false,false);}	
				-->
			</script><div xmlns:fn="http://www.w3.org/2005/xpath-functions" class="MainContent"><table class="classHeaderTable" cellpadding="0" cellspacing="0"><tr><td class="classHeaderTableLabel">Package</td><td><a href="package-detail.html" onclick="javascript:loadClassListFrame('class-list.html')">com.myflashlab.air.extensions.firebase.firestore</a></td></tr><tr><td class="classHeaderTableLabel">Class</td><td class="classSignature">public  class  Transaction</td></tr><tr><td class="classHeaderTableLabel">Inheritance</td><td class="inheritanceList">Transaction  <img src="../../../../../../images/inherit-arrow.gif" title="Inheritance" alt="Inheritance" class="inheritArrow"> flash.events.EventDispatcher</td></tr></table><p></p><p></p><p></p><p></p>
 A Transaction is passed to a native detached thread to provide the methods to read and write data within the
 transaction context. Only one transaction can be active at any time. When working with Transactions, consider the
 following outline.
 <ul>
                  <li>Create, then execute tha transaction instance</li>
                  <li>Read Documents when FirestoreEvents.TRANSACTION_BEGIN happens</li>
                  <li>Evaluate and change the read data, then decide if you want to keep or abort the transaction</li>
                  <li>Never change your UI based on the read data. Instead, set the outcome property with a payload</li>
                  <li>When transaction is completed, change your app ui based on the outcome payload you had set before</li>
                  <li>FirestoreEvents.TRANSACTION_BEGIN may happen multiple times if other users are writting the target values at the same time</li>
               </ul>
            <p></p><p><a href="#includeExamplesSummary">View the examples</a></p><br/><hr></div><a name="propertySummary"></a><div class="summarySection"><div class="summaryTableTitle">Public Properties</div><table cellspacing="0" cellpadding="3" class="summaryTable " id="summaryTableProperty"><tr><th>&nbsp;</th><th colspan="2">Property</th><th class="summaryTableOwnerCol">Defined By</th></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><a href="#outcome" class="signatureLink">outcome</a> : String<div class="summaryTableDescription">[write-only] 
	 Exactly before calling the keep method, you must set your transaction outcome in this property.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr></table></div><a name="methodSummary"></a><div class="summarySection"><div class="summaryTableTitle">Public Methods </div><table cellspacing="0" cellpadding="3" class="summaryTable " id="summaryTableMethod"><tr><th>&nbsp;</th><th colspan="2">Method</th><th class="summaryTableOwnerCol">Defined By</th></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#abort()" class="signatureLink">abort</a>():void</div><div class="summaryTableDescription">
	 Call this method if you want to abort your transaction.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#execute()" class="signatureLink">execute</a>():void</div><div class="summaryTableDescription">
	 
	 Executes the transaction and then attempts to commit the changes applied within the transaction.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#keep()" class="signatureLink">keep</a>():void</div><div class="summaryTableDescription">
	 Call this method if you want to keep your transaction.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#omit()" class="signatureLink">omit</a>($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $onComplete:Function):void</div><div class="summaryTableDescription">
	 Deletes the document referred to by the provided DocumentReference.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#read()" class="signatureLink">read</a>($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $onComplete:Function):void</div><div class="summaryTableDescription">
	 Reads the document referenced by this DocumentReference
	 	 </div></td><td class="summaryTableOwnerCol">Transaction</td></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#update()" class="signatureLink">update</a>($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $data:Object, $onComplete:Function):void</div><div class="summaryTableDescription">
	 Updates fields in the document referred to by the provided DocumentReference.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr><tr class=""><td class="summaryTablePaddingCol">&nbsp;</td><td class="summaryTableInheritanceCol">&nbsp;</td><td class="summaryTableSignatureCol"><div class="summarySignature"><a href="#write()" class="signatureLink">write</a>($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $data:Object, $onComplete:Function, $options:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/SetOptions.html">SetOptions</a> = null):void</div><div class="summaryTableDescription">
	 Writes to the document referred to by the provided DocumentReference.</div></td><td class="summaryTableOwnerCol">Transaction</td></tr></table></div><script language="javascript" type="text/javascript"><!--
										showHideInherited();
										--></script><div class="MainContent"><div class="detailSectionHeader">Property Detail</div><a name="propertyDetail"></a><a name="outcome"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">outcome</td><td class="detailHeaderType">property</td></tr></table><div class="detailBody"><code>outcome:String</code>&nbsp;&nbsp;[write-only] <p></p><p></p><p>
	 Exactly before calling the <code>keep</code> method, you must set your transaction outcome in this property.
	 this value will be returned to you with the <code>FirestoreEvents.TRANSACTION_COMPLETE</code> listener.
	 	 </p><br/><span class="label"> Implementation </span><br/><code>&nbsp;&nbsp;&nbsp;&nbsp;public function set outcome(value:String):void</code><br/></div><a name="methodDetail"></a><div class="detailSectionHeader">Method Detail</div><a name="abort()"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">abort</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td></tr></table><div class="detailBody"><code> public function abort():void</code><p></p><p></p><p>
	 Call this method if you want to abort your transaction.
	 </p></div><a name="execute()"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">execute</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td><td class="detailHeaderRule">&nbsp;</td></tr></table><div class="detailBody"><code> public function execute():void</code><p></p><p></p><p>
	 <p>
	 Executes the transaction and then attempts to commit the changes applied within the transaction. If any document
	 read within the transaction has changed, the updateFunction will be retried. If it fails to commit after 5
	 attempts, the transaction will fail.
	 </p>
	 	 <p>
	 You must create new instance of Transactions by calling <code>Firestore.createTransaction()</code>. Only one
	 transaction can be active at any time.
	 </p>
	 	 </p><p><span class="label">See also</span></p><div class="seeAlso"><a href="Firestore.html#createTransaction()" target="">Firestore.createTransaction()</a></div></div><a name="keep()"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">keep</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td><td class="detailHeaderRule">&nbsp;</td></tr></table><div class="detailBody"><code> public function keep():void</code><p></p><p></p><p>
	 Call this method if you want to keep your transaction. Make sure you have set the transaction "outcome" property.
	 </p></div><a name="omit()"></a><a name="omit(com.myflashlab.air.extensions.firebase.firestore.DocumentReference,Function)"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">omit</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td><td class="detailHeaderRule">&nbsp;</td></tr></table><div class="detailBody"><code> public function omit($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $onComplete:Function):void</code><p></p><p></p><p>
	 Deletes the document referred to by the provided DocumentReference.
	 	 </p><p><span class="label"> Parameters </span><table cellpadding="0" cellspacing="0" border="0"><tr><td width="20px"></td><td><code><span class="label">$document</span>:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a></code> &mdash; 	The DocumentReference to delete.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$onComplete</span>:Function</code> &mdash; Function to be called when the process completes. This function expects "no" parameters.
	 </td></tr></table></p></div><a name="read()"></a><a name="read(com.myflashlab.air.extensions.firebase.firestore.DocumentReference,Function)"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">read</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td><td class="detailHeaderRule">&nbsp;</td></tr></table><div class="detailBody"><code> public function read($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $onComplete:Function):void</code><p></p><p></p><p>
	 Reads the document referenced by this DocumentReference
	 	 </p><p><span class="label"> Parameters </span><table cellpadding="0" cellspacing="0" border="0"><tr><td width="20px"></td><td><code><span class="label">$document</span>:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a></code> &mdash; 	The DocumentReference to read.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$onComplete</span>:Function</code> &mdash; 	Function to be called when the process completes. This function expects "two" parameters as
	 follow: <code>function onComplete($snapshot:DocumentSnapshot, $err:String):void</code> if $err is not null,
	 it means the "read" has been successfull and $snapshot will be available.
	 </td></tr></table></p></div><a name="update()"></a><a name="update(com.myflashlab.air.extensions.firebase.firestore.DocumentReference,Object,Function)"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">update</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td><td class="detailHeaderRule">&nbsp;</td></tr></table><div class="detailBody"><code> public function update($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $data:Object, $onComplete:Function):void</code><p></p><p></p><p>
	 Updates fields in the document referred to by the provided DocumentReference. If no document exists yet, the
	 update will fail.
	 	 </p><p><span class="label"> Parameters </span><table cellpadding="0" cellspacing="0" border="0"><tr><td width="20px"></td><td><code><span class="label">$document</span>:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a></code> &mdash; 	The DocumentReference to update.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$data</span>:Object</code> &mdash; 		An object to update. Fields can contain dots to reference nested fields within the document.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$onComplete</span>:Function</code> &mdash; Function to be called when the process completes. This function expects "no" parameters.
	 </td></tr></table></p></div><a name="write()"></a><a name="write(com.myflashlab.air.extensions.firebase.firestore.DocumentReference,Object,Function,com.myflashlab.air.extensions.firebase.firestore.SetOptions)"></a><table class="detailHeader" cellpadding="0" cellspacing="0"><tr><td class="detailHeaderName">write</td><td class="detailHeaderParens">()</td><td class="detailHeaderType">method</td><td class="detailHeaderRule">&nbsp;</td></tr></table><div class="detailBody"><code> public function write($document:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a>, $data:Object, $onComplete:Function, $options:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/SetOptions.html">SetOptions</a> = null):void</code><p></p><p></p><p>
	 Writes to the document referred to by the provided DocumentReference. If the document does not yet exist, it
	 will be created. If you pass SetOptions, the provided data can be merged into an existing document.
	 	 </p><p><span class="label"> Parameters </span><table cellpadding="0" cellspacing="0" border="0"><tr><td width="20px"></td><td><code><span class="label">$document</span>:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/DocumentReference.html">DocumentReference</a></code> &mdash; 	The DocumentReference to overwrite.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$data</span>:Object</code> &mdash; 		An Object of the fields and values for the document.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$onComplete</span>:Function</code> &mdash; Function to be called when the process completes. This function expects "no" parameters.
	 </td></tr><tr><td class="paramSpacer">&nbsp;</td></tr><tr><td width="20px"></td><td><code><span class="label">$options</span>:<a href="../../../../../../com/myflashlab/air/extensions/firebase/firestore/SetOptions.html">SetOptions</a></code> (default = <code>null</code>)<code></code> &mdash; 	An object to configure the set behavior.
	 </td></tr></table></p></div><a name="includeExamplesSummary"></a><div class="detailSectionHeader">Examples</div><div class="detailBody">The following example shows how to work with transactions.
  <div class="listing" version="3.0"><pre>
 var trans:Transaction = Firestore.createTransaction();
 if(trans)
 {
     myTransaction = trans;
     &nbsp;
     myTransaction.addEventListener(FirestoreEvents.TRANSACTION_BEGIN, onTransactionBegin);
     myTransaction.addEventListener(FirestoreEvents.TRANSACTION_COMPLETE, onTransactionComplete);
     myTransaction.addEventListener(FirestoreEvents.TRANSACTION_FAILURE, onTransactionFailure);
     &nbsp;
     // to start working with the transaction, you must wait for the "TRANSACTION_BEGIN" event to happen
     myTransaction.execute();
 }
 else
 {
     // Every transaction will be finished when you call either of these methods:
     // myTransaction.abort();
     // myTransaction.keep();
     trace("another transaction is not released yet");
 }
 &nbsp;
 function onTransactionBegin(e:FirestoreEvents):void
 {
     trace("&gt;&gt; onTransactionBegin");
     &nbsp;
     // If you want to read more that one DocumentReference, you must read each inside the prior onReadComplete functions.
     myTransaction.read(myDocument, onReadComplete);
 }
 &nbsp;
 function onReadComplete($snapshot:DocumentSnapshot, $err:String):void
 {
     if($err)
     {
         trace("could not read the document: " + $err);
         myTransaction.abort();
     }
     else
     {
         trace("ReadSuccess, data: " + JSON.stringify($snapshot.data));
         &nbsp;
         // increment the current value in database
         var newValue:int = $snapshot.data.population + 1;
         &nbsp;
         &nbsp;
         if(newValue &gt; 1000000)
         {
             trace("value is more than what our game needs.");
             myTransaction.abort();
         }
         else
         {
             &nbsp;
             // payload message will be delivered to the TRANSACTION_COMPLETE event.
             // you must change your UI based on this message known as the transaction outcome.
             // in our example, you must not use the "newValue" value to change your UI, instead
             // you must pass it through the "keep()" method and change your UI when TRANSACTION_COMPLETE
             // happens.
             &nbsp;
             myTransaction.outcome = "payload message which can be anything for example a json String";
             myTransaction.update(myDocument, {population:newValue}, onUpdateComplete);
         }
     }
 }
 &nbsp;
 function onUpdateComplete():void
 {
     &nbsp;
     // You must call the "keep" method when you are sure the "write, update or omit" commands have
     // finished their job. In this example, we are calling the "keep" method when the last "update"
     // method is finished through "onUpdateComplete"
     &nbsp;
     myTransaction.keep();
 }
 &nbsp;
 function onTransactionComplete(e:FirestoreEvents):void
 {
     trace("onTransactionComplete: " + e.transactionOutcome);
     &nbsp;
     myTransaction.removeEventListener(FirestoreEvents.TRANSACTION_BEGIN, onTransactionBegin);
     myTransaction.removeEventListener(FirestoreEvents.TRANSACTION_COMPLETE, onTransactionComplete);
     myTransaction.removeEventListener(FirestoreEvents.TRANSACTION_FAILURE, onTransactionFailure);
 }
 &nbsp;
 function onTransactionFailure(e:FirestoreEvents):void
 {
     trace("onTransactionFailure: " + e.msg);
     &nbsp;
     myTransaction.removeEventListener(FirestoreEvents.TRANSACTION_BEGIN, onTransactionBegin);
     myTransaction.removeEventListener(FirestoreEvents.TRANSACTION_COMPLETE, onTransactionComplete);
     myTransaction.removeEventListener(FirestoreEvents.TRANSACTION_FAILURE, onTransactionFailure);
 }
 </pre></div>
 </div><br/><br/><hr><br/><p></p><center class="copyright"><footer>myflashlabs.com - Born to Mobilize The Future</footer><br/>Sun Jun 10 2018, 05:22 PM +04:00  </center></div></body></html><!--myflashlabs.com - Born to Mobilize The Future<br/>Sun Jun 10 2018, 05:22 PM +04:00  -->